with "air-pamm.skill";

/**
Contains information equivalent to andersen analysis, 
which is used to create heap fragments.
*/
annotation HeapStructure {
	auto Program target;
	v64 heapSize;
	HeapObject[heapSize] heap;
	/** Flow and context insensitive heap structure. */
	PointsToSet[heapSize] heapStructure;
}

PointsToSet {
	HeapObject[] targets;
}


/**
Detailed poinsto information containing context and flow information.
*/
annotation DetailedHeapStructure {
	auto Program target;
	/** Function ⇀ Instruction ⇀ PoinstToSet */
	auto map<Function, Instruction, PointsToSet> payload;
}
